<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Roblox — Комментарии и Регистрация</title>
<style>
/* Общий стиль (оставляйте предыдущие стили) */
* {
    box-sizing: border-box;
}
body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #ff5858 0%, #f09819 100%);
    color: #222;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
}
/* Заголовки */
h1 {
    color: white;
    font-weight: 700;
    margin-bottom: 20px;
    text-shadow: 0 2px 5px rgba(0,0,0,0.3);
    text-align: center;
    user-select: none;
}
h2 {
    margin-top: 0;
    margin-bottom: 15px;
    color: #d32f2f;
    font-weight: 700;
}
</style>
</head>
<body>

<h1>Roblox — Комментарии и Регистрация</h1>

<div id="auth-section" style="width: 100%; max-width: 600px; display: flex; flex-direction: column; gap: 20px; margin-bottom:20px;">
  <!-- Блоки регистрации и входа будут вставлены сюда через JS -->
</div>

<div class="container" id="main-content" style="display: none; width: 100%; max-width: 600px; background: #fff; padding: 20px; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.1);">
  <div class="game-info">
    <h2>Что такое Roblox?</h2>
    <p>...</p> <!-- ваш контент о Roblox (оставьте предыдущий код) -->
  </div>

  <!-- Комментарии и форма логина -->
  <label for="username">Ваше имя</label>
  <input type="text" id="username" placeholder="Введите ваше имя" maxlength="30" autocomplete="off" autocapitalize="words" />

  <label for="comment">Комментарий</label>
  <textarea id="comment" placeholder="Напишите ваш комментарий" maxlength="300"></textarea>

  <button id="submitBtn">Отправить</button>

  <div class="comments-section" id="commentsSection" aria-live="polite" aria-label="Комментарии пользователей"></div>
</div>

<div class="footer" style="margin-top:50px; text-align:center;">
    &copy; 2024 Roblox Comments Site
</div>

<script>
// --- Регистрация и вход с email ---
const authSection = document.getElementById('auth-section');
const mainContent = document.getElementById('main-content');

let currentUser = null;

// Проверка авторизации при загрузке
const storedUser = localStorage.getItem('user');
if (storedUser) {
    currentUser = JSON.parse(storedUser);
    showMainContent();
} else {
    showAuthOptions();
}

// Функции
function showAuthOptions() {
    authSection.innerHTML = '';

    const registerBtn = document.createElement('button');
    registerBtn.textContent = 'Зарегистрироваться как Roblox';
    styleButton(registerBtn, '#d32f2f');

    const loginBtn = document.createElement('button');
    loginBtn.textContent = 'Войти как Roblox';
    styleButton(loginBtn, '#555');

    authSection.appendChild(registerBtn);
    authSection.appendChild(loginBtn);

    registerBtn.onclick = showRegisterForm;
    loginBtn.onclick = showLoginEmailForm;
}

function styleButton(btn, bgColor) {
    btn.style.padding = '12px';
    btn.style.fontSize = '1rem';
    btn.style.borderRadius = '8px';
    btn.style.border = 'none';
    btn.style.backgroundColor = bgColor;
    btn.style.color = '#fff';
    btn.style.cursor = 'pointer';
}

// Форма регистрации
function showRegisterForm() {
    authSection.innerHTML = '';

    const form = document.createElement('div');

    form.innerHTML = `
        <h3 style="margin-top:0;">Регистрация</h3>
        <input type="text" id="reg-username" placeholder="Имя" style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ccc;">
        <input type="password" id="reg-password" placeholder="Пароль" style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ccc;">
        <input type="email" id="reg-email" placeholder="Email" style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ccc;">
        <button style="width:100%; padding:10px; background:#d32f2f; color:#fff; border:none; border-radius:8px; font-size:1rem;">Зарегистрироваться</button>
        <button style="width:100%; padding:10px; margin-top:10px; background:#555; color:#fff; border:none; border-radius:8px; font-size:1rem;">Отмена</button>
    `;
    authSection.appendChild(form);

    form.querySelector('button').onclick = () => {
        const username = document.getElementById('reg-username').value.trim();
        const password = document.getElementById('reg-password').value.trim();
        const email = document.getElementById('reg-email').value.trim();
        if (!username || !password || !email) {
            alert('Заполните все поля');
            return;
        }
        // сохраняем аккаунт с email
        localStorage.setItem('user', JSON.stringify({ username, password, email }));
        currentUser = { username, email };
        showMainContent();
    };
    form.querySelectorAll('button')[1].onclick = showAuthOptions; // отмена
}

// Форма входа (по email)
function showLoginEmailForm() {
    authSection.innerHTML = '';

    const form = document.createElement('div');

    form.innerHTML = `
        <h3 style="margin-top:0;">Вход</h3>
        <input type="email" id="login-email" placeholder="Email" style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ccc;">
        <input type="password" id="login-password" placeholder="Пароль" style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ccc;">
        <button style="width:100%; padding:10px; background:#d32f2f; color:#fff; border:none; border-radius:8px; font-size:1rem;">Войти</button>
        <button style="width:100%; padding:10px; margin-top:10px; background:#555; color:#fff; border:none; border-radius:8px; font-size:1rem;">Отмена</button>
    `;
    authSection.appendChild(form);

    form.querySelector('button').onclick = () => {
        const email = document.getElementById('login-email').value.trim();
        const password = document.getElementById('login-password').value.trim();
        const storedUser = JSON.parse(localStorage.getItem('user'));
        if (storedUser && storedUser.email === email && storedUser.password === password) {
            currentUser = { username: storedUser.username, email: storedUser.email };
            showMainContent();
        } else {
            alert('Неверный email или пароль');
        }
    };
    form.querySelectorAll('button')[1].onclick = showAuthOptions; // отмена
}

function showMainContent() {
    authSection.innerHTML = '';
    document.getElementById('main-content').style.display = 'block';
    // отображение имени
    if (currentUser) {
        document.getElementById('username').value = currentUser.username;
    }
    // рендер комментариев
    renderComments();
}

// --- комментарии ---
const submitBtn = document.getElementById('submitBtn');
const commentsSection = document.getElementById('commentsSection');
const commentInput = document.getElementById('comment');

let comments = JSON.parse(localStorage.getItem('comments')) || [];

function renderComments() {
    commentsSection.innerHTML = '';
    comments.forEach(c => {
        const commentDiv = document.createElement('div');
        commentDiv.className = 'comment';

        const usernameElem = document.createElement('div');
        usernameElem.className = 'username';
        usernameElem.textContent = c.username;

        const textElem = document.createElement('div');
        textElem.className = 'text';
        textElem.textContent = c.comment;

        commentDiv.appendChild(usernameElem);
        commentDiv.appendChild(textElem);
        commentsSection.appendChild(commentDiv);
    });
}

if (currentUser) {
    document.getElementById('username').value = currentUser.username;
    renderComments();
}

submitBtn.onclick = () => {
    if (!currentUser) {
        alert('Пожалуйста, войдите или зарегистрируйтесь.');
        return;
    }
    const username = currentUser.username; // фиксируем имя
    const comment = commentInput.value.trim();
    if (!comment) {
        alert('Напишите комментарий');
        return;
    }
    const newComment = { username, comment };
    comments.push(newComment);
    localStorage.setItem('comments', JSON.stringify(comments));
    renderComments();
    commentInput.value = '';
    commentsSection.scrollTop = commentsSection.scrollHeight;
};
</script>

</body>
</html>